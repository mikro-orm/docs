<!DOCTYPE html>
<html lang="en" data-theme="">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<script type="text/javascript">/*<![CDATA[*/window.__chunkMapping={"main":["/docs/v3-new/main.793cb434c091c1734636.css","/docs/v3-new/main.26dd6f9550a16264f5a7.js"],"component---site-src-pages-index-jsc-4-f-f99":["/docs/v3-new/component---site-src-pages-index-jsc-4-f-f99.9f99729bff7f082bd679.css","/docs/v3-new/component---site-src-pages-index-jsc-4-f-f99.6064828857a203b5f626.js"],"component---theme-blog-post-pageccc-cab":["/docs/v3-new/component---theme-blog-post-pageccc-cab.42d18faa279882580cbb.css","/docs/v3-new/component---theme-blog-post-pageccc-cab.c8932e37fadee032058f.js"],"content---v-3-new-blog-handling-transactions-and-concurrency-in-mikroorm-9-b-1-68b":["/docs/v3-new/content---v-3-new-blog-handling-transactions-and-concurrency-in-mikroorm-9-b-1-68b.4685a455e312330cabbc.js"],"metadata---v-3-new-blog-handling-transactions-and-concurrency-in-mikroorm-051-a7e":["/docs/v3-new/metadata---v-3-new-blog-handling-transactions-and-concurrency-in-mikroorm-051-a7e.0396c47407c744c32387.js"],"nextItem---v-3-new-blog-handling-transactions-and-concurrency-in-mikroorm-866-6b4":["/docs/v3-new/nextItem---v-3-new-blog-handling-transactions-and-concurrency-in-mikroorm-866-6b4.1830455a05011e1f9c73.js"],"content---v-3-new-blog-introducing-mikroorm-typescript-data-mapper-orm-with-identity-mapf-49-9fa":["/docs/v3-new/content---v-3-new-blog-introducing-mikroorm-typescript-data-mapper-orm-with-identity-mapf-49-9fa.ea466ac487cc46d31673.js"],"component---theme-blog-list-pagea-6-a-7ba":["/docs/v3-new/component---theme-blog-list-pagea-6-a-7ba.42d18faa279882580cbb.css","/docs/v3-new/component---theme-blog-list-pagea-6-a-7ba.c729938cf569281f796e.js"],"content---v-3-new-bloge-7-c-882":["/docs/v3-new/content---v-3-new-bloge-7-c-882.458065b8057487ca974f.js"],"content---v-3-new-blog-316-9d2":["/docs/v3-new/content---v-3-new-blog-316-9d2.708b82b15f823c2f8438.js"],"metadata---v-3-new-bloge-85-503":["/docs/v3-new/metadata---v-3-new-bloge-85-503.3e65b9e9e8b911423fc9.js"],"component---theme-doc-page-1-be-9be":["/docs/v3-new/component---theme-doc-page-1-be-9be.a7dc664af81736e8f518.css","/docs/v3-new/component---theme-doc-page-1-be-9be.d3bc93f077e7a2f8d173.js"],"docsMetadata---v-3-new-docs-988-80a":["/docs/v3-new/docsMetadata---v-3-new-docs-988-80a.a30ed25232e4920e6fec.js"],"component---theme-doc-item-178-a40":["/docs/v3-new/component---theme-doc-item-178-a40.de2648345892298aff25.css","/docs/v3-new/component---theme-doc-item-178-a40.75f4842c571107d99831.js"],"content---v-3-new-docs-cascadinga-12-311":["/docs/v3-new/content---v-3-new-docs-cascadinga-12-311.9ca9c531a5d9cfc23e1e.js"],"metadata---v-3-new-docs-cascadingce-0-3b0":["/docs/v3-new/metadata---v-3-new-docs-cascadingce-0-3b0.6aa81aa2acc27536d221.js"],"content---v-3-new-docs-collections-22-d-26b":["/docs/v3-new/content---v-3-new-docs-collections-22-d-26b.ce1c82aae93396150f17.js"],"metadata---v-3-new-docs-collectionsa-6-c-f79":["/docs/v3-new/metadata---v-3-new-docs-collectionsa-6-c-f79.bb32067976b6afc5593c.js"],"content---v-3-new-docs-debugging-2-bc-e9a":["/docs/v3-new/content---v-3-new-docs-debugging-2-bc-e9a.99c47f2818dff498b69c.js"],"metadata---v-3-new-docs-debuggingb-3-e-ca1":["/docs/v3-new/metadata---v-3-new-docs-debuggingb-3-e-ca1.a69bf70884979409deaa.js"],"content---v-3-new-docs-custom-driverd-74-3f1":["/docs/v3-new/content---v-3-new-docs-custom-driverd-74-3f1.49e6013f13bc2e677d47.js"],"metadata---v-3-new-docs-custom-driverc-52-55e":["/docs/v3-new/metadata---v-3-new-docs-custom-driverc-52-55e.5c3ecdabe20bc4fcfa6d.js"],"content---v-3-new-docs-deploymenta-37-e55":["/docs/v3-new/content---v-3-new-docs-deploymenta-37-e55.c4f0c7e70e2264069fe6.js"],"metadata---v-3-new-docs-deployment-87-f-f4e":["/docs/v3-new/metadata---v-3-new-docs-deployment-87-f-f4e.a5789209685451fc3d18.js"],"content---v-3-new-docs-defining-entitiesfb-6-d0f":["/docs/v3-new/content---v-3-new-docs-defining-entitiesfb-6-d0f.13e3f4f256ffa77b75b5.js"],"metadata---v-3-new-docs-defining-entities-9-b-5-c7a":["/docs/v3-new/metadata---v-3-new-docs-defining-entities-9-b-5-c7a.609651ec47fbe833b57e.js"],"content---v-3-new-docs-entity-constructors-18-f-b4b":["/docs/v3-new/content---v-3-new-docs-entity-constructors-18-f-b4b.4ce00ddf121b05c6194d.js"],"metadata---v-3-new-docs-entity-constructors-97-d-f60":["/docs/v3-new/metadata---v-3-new-docs-entity-constructors-97-d-f60.863f2e301697df4f416f.js"],"content---v-3-new-docs-entity-generator-29-b-a00":["/docs/v3-new/content---v-3-new-docs-entity-generator-29-b-a00.43f32cdc00d8a2186a15.js"],"metadata---v-3-new-docs-entity-generator-957-63c":["/docs/v3-new/metadata---v-3-new-docs-entity-generator-957-63c.f52ade37b4103a33c775.js"],"content---v-3-new-docs-entity-helper-7-b-9-fc9":["/docs/v3-new/content---v-3-new-docs-entity-helper-7-b-9-fc9.461c433998f83beb7ec6.js"],"metadata---v-3-new-docs-entity-helper-147-667":["/docs/v3-new/metadata---v-3-new-docs-entity-helper-147-667.0eb92644198a87db6f0d.js"],"content---v-3-new-docs-entity-manager-51-d-7a0":["/docs/v3-new/content---v-3-new-docs-entity-manager-51-d-7a0.904fcf572126dd85a66e.js"],"metadata---v-3-new-docs-entity-manager-178-be9":["/docs/v3-new/metadata---v-3-new-docs-entity-manager-178-be9.6112a581816a6bdd1445.js"],"content---v-3-new-docs-identity-map-623-510":["/docs/v3-new/content---v-3-new-docs-identity-map-623-510.31a704264e90815b81e1.js"],"metadata---v-3-new-docs-identity-mapa-5-f-8d0":["/docs/v3-new/metadata---v-3-new-docs-identity-mapa-5-f-8d0.d078ae64bea53873a057.js"],"content---v-3-new-docs-entity-references-79-b-77c":["/docs/v3-new/content---v-3-new-docs-entity-references-79-b-77c.d679999c173530da9fa9.js"],"metadata---v-3-new-docs-entity-references-83-d-749":["/docs/v3-new/metadata---v-3-new-docs-entity-references-83-d-749.64f0d35c1ee38f3dcd69.js"],"content---v-3-new-docs-indexc-37-10a":["/docs/v3-new/content---v-3-new-docs-indexc-37-10a.619e83350b6f35e56963.js"],"metadata---v-3-new-docs-index-90-a-05c":["/docs/v3-new/metadata---v-3-new-docs-index-90-a-05c.1fa9c99f39a2566038e1.js"],"content---v-3-new-docs-lifecycle-hooksc-72-599":["/docs/v3-new/content---v-3-new-docs-lifecycle-hooksc-72-599.ed51af9abd6d6853bce3.js"],"metadata---v-3-new-docs-lifecycle-hooks-434-d5c":["/docs/v3-new/metadata---v-3-new-docs-lifecycle-hooks-434-d5c.082eaf4132d35a1b916b.js"],"content---v-3-new-docs-installation-3-b-8-582":["/docs/v3-new/content---v-3-new-docs-installation-3-b-8-582.4c09a8f297b1c54afa60.js"],"metadata---v-3-new-docs-installationdf-8-f58":["/docs/v3-new/metadata---v-3-new-docs-installationdf-8-f58.cf6df888641a45f83c59.js"],"content---v-3-new-docs-metadata-cache-081-342":["/docs/v3-new/content---v-3-new-docs-metadata-cache-081-342.8ba36ba72f34135f839a.js"],"metadata---v-3-new-docs-metadata-cacheafe-560":["/docs/v3-new/metadata---v-3-new-docs-metadata-cacheafe-560.d9fdf88aaa66ec2c0df7.js"],"content---v-3-new-docs-migrationsd-04-7b0":["/docs/v3-new/content---v-3-new-docs-migrationsd-04-7b0.9805c8ee45657180d6b6.js"],"metadata---v-3-new-docs-migrations-8-c-4-0c8":["/docs/v3-new/metadata---v-3-new-docs-migrations-8-c-4-0c8.58215d957a13a95bce9a.js"],"content---v-3-new-docs-naming-strategycd-7-ba8":["/docs/v3-new/content---v-3-new-docs-naming-strategycd-7-ba8.3e02f9f3e1bb399bab02.js"],"metadata---v-3-new-docs-naming-strategyab-4-f45":["/docs/v3-new/metadata---v-3-new-docs-naming-strategyab-4-f45.58a2b40e359b3e469ece.js"],"content---v-3-new-docs-multiple-schemas-3-a-3-8e5":["/docs/v3-new/content---v-3-new-docs-multiple-schemas-3-a-3-8e5.b2602d62ac4db70445d8.js"],"metadata---v-3-new-docs-multiple-schemas-721-622":["/docs/v3-new/metadata---v-3-new-docs-multiple-schemas-721-622.b20ad086f078b54d94ca.js"],"content---v-3-new-docs-nested-populatea-1-d-590":["/docs/v3-new/content---v-3-new-docs-nested-populatea-1-d-590.1396a610e0e0714a5c00.js"],"metadata---v-3-new-docs-nested-populate-781-d54":["/docs/v3-new/metadata---v-3-new-docs-nested-populate-781-d54.fd31bf1fedab3004a99d.js"],"content---v-3-new-docs-query-builder-4-fe-8a7":["/docs/v3-new/content---v-3-new-docs-query-builder-4-fe-8a7.12d3cdcf5c133383c7a1.js"],"metadata---v-3-new-docs-query-builderdac-d4d":["/docs/v3-new/metadata---v-3-new-docs-query-builderdac-d4d.418858fb621cd90d2eaf.js"],"content---v-3-new-docs-property-validation-282-146":["/docs/v3-new/content---v-3-new-docs-property-validation-282-146.1d3628c498fcf05b2f45.js"],"metadata---v-3-new-docs-property-validationd-93-688":["/docs/v3-new/metadata---v-3-new-docs-property-validationd-93-688.3848b31b81d16d47c36a.js"],"content---v-3-new-docs-query-conditions-523-972":["/docs/v3-new/content---v-3-new-docs-query-conditions-523-972.6e6367a11bcd7d8f6c2d.js"],"metadata---v-3-new-docs-query-conditionsbec-242":["/docs/v3-new/metadata---v-3-new-docs-query-conditionsbec-242.0e0eb311c79225607344.js"],"content---v-3-new-docs-read-connections-7-c-6-18f":["/docs/v3-new/content---v-3-new-docs-read-connections-7-c-6-18f.3527754efa69cf8219ad.js"],"metadata---v-3-new-docs-read-connections-880-52e":["/docs/v3-new/metadata---v-3-new-docs-read-connections-880-52e.e117b11a2f6615d9eb41.js"],"content---v-3-new-docs-relationshipsec-5-70e":["/docs/v3-new/content---v-3-new-docs-relationshipsec-5-70e.76b81da813a7bb4880f8.js"],"metadata---v-3-new-docs-relationships-54-d-d17":["/docs/v3-new/metadata---v-3-new-docs-relationships-54-d-d17.846fab91c3df0360a4b8.js"],"content---v-3-new-docs-repositories-3-ec-f84":["/docs/v3-new/content---v-3-new-docs-repositories-3-ec-f84.500f51f82d9d73aff8bb.js"],"metadata---v-3-new-docs-repositoriesaca-a1e":["/docs/v3-new/metadata---v-3-new-docs-repositoriesaca-a1e.a11fba3ddcf57f81f892.js"],"content---v-3-new-docs-schema-generator-4-f-4-ede":["/docs/v3-new/content---v-3-new-docs-schema-generator-4-f-4-ede.c50bcb750c91a32b6b66.js"],"metadata---v-3-new-docs-schema-generatorcb-7-fbd":["/docs/v3-new/metadata---v-3-new-docs-schema-generatorcb-7-fbd.c348ca57b11daafcb98c.js"],"content---v-3-new-docs-serializing-460-27d":["/docs/v3-new/content---v-3-new-docs-serializing-460-27d.ed798dfe9dc8f23d85cb.js"],"metadata---v-3-new-docs-serializing-24-b-d56":["/docs/v3-new/metadata---v-3-new-docs-serializing-24-b-d56.d839348de87fe58ca17d.js"],"content---v-3-new-docs-transactions-2-ec-56d":["/docs/v3-new/content---v-3-new-docs-transactions-2-ec-56d.2580291fe8ca1be3124c.js"],"metadata---v-3-new-docs-transactionsd-0-a-1a2":["/docs/v3-new/metadata---v-3-new-docs-transactionsd-0-a-1a2.fd0cf8f6ea39e5b93453.js"],"content---v-3-new-docs-upgrading-v-2-to-v-33-bf-264":["/docs/v3-new/content---v-3-new-docs-upgrading-v-2-to-v-33-bf-264.f9a414105e3b8342fb4d.js"],"metadata---v-3-new-docs-upgrading-v-2-to-v-3-bb-2-ab9":["/docs/v3-new/metadata---v-3-new-docs-upgrading-v-2-to-v-3-bb-2-ab9.6a8816928432d6318759.js"],"content---v-3-new-docs-unit-of-work-24-a-b0d":["/docs/v3-new/content---v-3-new-docs-unit-of-work-24-a-b0d.561d13d501d770484593.js"],"metadata---v-3-new-docs-unit-of-worka-89-387":["/docs/v3-new/metadata---v-3-new-docs-unit-of-worka-89-387.57ad2e7d97ae78f432ef.js"],"content---v-3-new-docs-usage-with-js-253-8af":["/docs/v3-new/content---v-3-new-docs-usage-with-js-253-8af.5e9ff6c74849bcabc641.js"],"metadata---v-3-new-docs-usage-with-jsbbe-2cc":["/docs/v3-new/metadata---v-3-new-docs-usage-with-jsbbe-2cc.2f39ccb0c21049ad23d4.js"],"content---v-3-new-docs-usage-with-mongo-563-c79":["/docs/v3-new/content---v-3-new-docs-usage-with-mongo-563-c79.dc963b895cc4613c3213.js"],"metadata---v-3-new-docs-usage-with-mongo-6-d-9-c90":["/docs/v3-new/metadata---v-3-new-docs-usage-with-mongo-6-d-9-c90.6f17d6d7dc11df759770.js"],"content---v-3-new-docs-usage-with-nestjsdf-7-676":["/docs/v3-new/content---v-3-new-docs-usage-with-nestjsdf-7-676.b95cba1e13e92f2dc137.js"],"metadata---v-3-new-docs-usage-with-nestjsf-64-d12":["/docs/v3-new/metadata---v-3-new-docs-usage-with-nestjsf-64-d12.537e5b216a87dd2f5c0f.js"],"content---v-3-new-docs-usage-with-sql-815-a4d":["/docs/v3-new/content---v-3-new-docs-usage-with-sql-815-a4d.c1cf51e51db141fc1536.js"],"metadata---v-3-new-docs-usage-with-sqlcc-4-f9e":["/docs/v3-new/metadata---v-3-new-docs-usage-with-sqlcc-4-f9e.1b547ce607c21b164bff.js"],"component---theme-blog-tags-posts-page-687-b6c":["/docs/v3-new/component---theme-blog-tags-posts-page-687-b6c.42d18faa279882580cbb.css","/docs/v3-new/component---theme-blog-tags-posts-page-687-b6c.fb285268d119390786e0.js"],"metadata---v-3-new-blog-tags-typescript-460-e1c":["/docs/v3-new/metadata---v-3-new-blog-tags-typescript-460-e1c.bd0d386a200978c73bb2.js"],"metadata---v-3-new-blog-tags-nodee-08-359":["/docs/v3-new/metadata---v-3-new-blog-tags-nodee-08-359.4c566e74a4bf7e84cc9c.js"],"metadata---v-3-new-blog-tags-javascriptfbb-45a":["/docs/v3-new/metadata---v-3-new-blog-tags-javascriptfbb-45a.72f4abe4e407e8fa780e.js"],"metadata---v-3-new-blog-tags-oop-925-509":["/docs/v3-new/metadata---v-3-new-blog-tags-oop-925-509.b240df5caaa3f1583792.js"],"metadata---v-3-new-blog-tags-sqlada-e6a":["/docs/v3-new/metadata---v-3-new-blog-tags-sqlada-e6a.adfdac95bf0e87c66efe.js"],"component---theme-blog-tags-list-page-01-a-d0b":["/docs/v3-new/component---theme-blog-tags-list-page-01-a-d0b.b0765e2572e903c4a57f.js"],"tags---v-3-new-blog-tags-2-b-9-d94":["/docs/v3-new/tags---v-3-new-blog-tags-2-b-9-d94.94d449203492109b9580.js"]};/*]]>*/</script>

<title data-react-helmet="true">upgrading-v2-to-v3</title>

<meta data-react-helmet="true" charset="utf-8"/><meta data-react-helmet="true" http-equiv="x-ua-compatible" content="ie=edge"/><meta data-react-helmet="true" name="viewport" content="width=device-width"/><meta data-react-helmet="true" property="og:title" content="MikroORM Â· TypeScript ORM for Node.js based on Data Mapper, Unit of Work and Identity Map patterns."/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="description" content="# Upgrading from v2 to v3"/><meta data-react-helmet="true" property="og:description" content="# Upgrading from v2 to v3"/><meta data-react-helmet="true" property="og:url" content="https://mikro-orm.github.io/docs/v3-new//docs/v3-new/docs/upgrading-v2-to-v3"/>

<link data-react-helmet="true" rel="shortcut icon" href="/docs/v3-new/img/favicon.ico"/>


<link rel="stylesheet" type="text/css" href="/docs/v3-new/main.793cb434c091c1734636.css" />

<link rel="stylesheet" type="text/css" href="/docs/v3-new/0.753b91118bbb7ba96e3c.css" />

<link rel="stylesheet" type="text/css" href="/docs/v3-new/1.c1a127e4736922edeb2a.css" />

<link rel="stylesheet" type="text/css" href="/docs/v3-new/component---theme-doc-page-1-be-9be.a7dc664af81736e8f518.css" />

<link rel="stylesheet" type="text/css" href="/docs/v3-new/component---theme-doc-item-178-a40.de2648345892298aff25.css" />

</head>
<body >
<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a aria-current="page" class="navbar__brand active" href="/docs/v3-new/"><img class="navbar__logo" src="/docs/v3-new/img/logo.svg" alt="MikroORM"/><strong class=""></strong></a><a class="navbar__item navbar__link" label="Docs" position="left" href="/docs/v3-new/docs/installation">Docs</a><a class="navbar__item navbar__link" label="Blog" position="left" href="/docs/v3-new/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="https://github.com/mikro-orm/mikro-orm" label="GitHub" position="right" target="_blank" rel="noopener noreferrer">GitHub</a><div class="react-toggle displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_16vC moon_1N64"></span></div><div class="react-toggle-track-x"><span class="toggle_16vC sun_3CZP"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"/></div></div></div><div role="presentation" class="navbar__sidebar__backdrop"></div><div class="navbar__sidebar"><div class="navbar__sidebar__brand"><a aria-current="page" class="navbar__brand active" href="/docs/v3-new/"><img class="navbar__logo" src="/docs/v3-new/img/logo.svg" alt="MikroORM"/><strong></strong></a></div><div class="navbar__sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" label="Docs" position="left" href="/docs/v3-new/docs/installation">Docs</a></li><li class="menu__list-item"><a class="menu__link" label="Blog" position="left" href="/docs/v3-new/blog">Blog</a></li><li class="menu__list-item"><a class="menu__link" href="https://github.com/mikro-orm/mikro-orm" label="GitHub" position="right" target="_blank" rel="noopener noreferrer">GitHub</a></li></ul></div></div></div></nav><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp"></div><main class="docMainContainer_FFX1"><div><div class="padding-vert--lg"><div class="container"><div class="row"><div class="col"><div class="docItemContainer_2cwg"><header><h1 class="docTitle_1vWb">upgrading-v2-to-v3</h1></header><article><div class="markdown"><h1><a aria-hidden="true" class="anchor" id="upgrading-from-v2-to-v3"></a><a aria-hidden="true" class="hash-link" href="#upgrading-from-v2-to-v3">#</a>Upgrading from v2 to v3</h1><p>Following sections describe (hopefully) all breaking changes, most of them might be not valid
for you, like if you do not use custom <code>NamingStrategy</code> implementation, you do not care about
the interface being changed.</p><h2><a aria-hidden="true" class="anchor" id="default-value-of-autoflush-has-changed-to-false"></a><a aria-hidden="true" class="hash-link" href="#default-value-of-autoflush-has-changed-to-false">#</a>Default value of autoFlush has changed to false</h2><blockquote><p>If you had <code>autoFlush: false</code> in your ORM configuration before, you can now remove
this line, no changes are needed in your app. </p></blockquote><p>Default value for <code>autoFlush</code> is now <code>false</code>. That means you need to call
<code>em.flush()</code> yourself to persist changes into database. You can still change this via ORM&#x27;s
options to ease the transition but generally it is not recommended as it can cause unwanted
small transactions being created around each <code>persist</code>. </p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2QGZ"><pre class="prism-code language-typescript codeBlock_19pQ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">orm</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">em</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">persist</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Entity</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// no auto-flushing by default</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">await</span><span class="token plain"> orm</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">em</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">flush</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">await</span><span class="token plain"> orm</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">em</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">persist</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Entity</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// you can still use second parameter to auto-flush</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button></div></pre><h2><a aria-hidden="true" class="anchor" id="reworked-entity-definition"></a><a aria-hidden="true" class="hash-link" href="#reworked-entity-definition">#</a>Reworked entity definition</h2><p>Now it is no longer needed to merge entities with <code>IEntity</code> interface, that was polluting entity&#x27;s
interface with internal methods. New interfaces <code>IdentifiedEntity&lt;T&gt;</code>, <code>UuidEntity&lt;T&gt;</code> and <code>MongoEntity&lt;T&gt;</code>
are introduced, that should be implemented by entities. They are not adding any new properties or methods,
keeping the entity&#x27;s interface clean.</p><p><code>IEntity</code> interface has been renamed to <code>AnyEntity&lt;T, PK&gt;</code> and it no longer has public methods
like <code>toJSON()</code>, <code>toObject()</code> or <code>init()</code>. One can use <code>wrap()</code> method provided by ORM that
will enhance property type when needed with those methods (<code>await wrap(book.author).init()</code>).
To keep all methods available on the entity, you can still use interface merging with
<code>WrappedEntity&lt;T, PK&gt;</code> that both extends <code>AnyEntity&lt;T, PK&gt;</code> and defines all those methods.</p><p>You will need to mark the entity by implementing one of <code>*Entity</code> interfaces:</p><ul><li><code>IdEntity&lt;T&gt;</code> for numeric/string PK on <code>id</code> property (<code>id: number</code>)</li><li><code>UuidEntity&lt;T&gt;</code> for string PK on <code>uuid</code> property (<code>uuid: string</code>)</li><li><code>MongoEntity&lt;T&gt;</code> for mongo, where <code>id: string</code> and <code>_id: ObjectId</code> are required</li><li><code>AnyEntity&lt;T, PK&gt;</code> for other possible properties (fill the PK property name to <code>PK</code>
parameter, e.g.: <code>AnyEntity&lt;Book, &#x27;myPrimaryProperty&#x27;&gt;&#x27;</code>)</li></ul><p>To keep all public methods that were part of <code>IEntity</code> interface in v2, you can use
<code>WrappedEntity&lt;T, PK&gt;</code> via interface merging:</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2QGZ"><pre class="prism-code language-typescript codeBlock_19pQ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">@</span><span class="token function maybe-class-name" style="color:rgb(130, 170, 255)">Entity</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Book</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><span class="token spread operator" style="color:rgb(137, 221, 255)">...</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">interface</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Book</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">extends</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">WrappedEntity</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token maybe-class-name">Book</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;id&#x27;</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button></div></pre><p>For more examples, take a look at <a href="/docs/v3-new/docs/defining-entities">defining entities section</a>.</p><h2><a aria-hidden="true" class="anchor" id="integrated-knexjs-as-query-builder-and-runner"></a><a aria-hidden="true" class="hash-link" href="#integrated-knexjs-as-query-builder-and-runner">#</a>Integrated Knex.js as query builder and runner</h2><p><code>QueryBuilder</code> now internally uses knex to run all queries. As knex already supports connection
pooling, this feature comes without any effort. New configuration for pooling is now available</p><p>Transactions now require using <code>em.transactional()</code> method, previous helpers
<code>beginTransaction</code>/<code>commit</code>/<code>rollback</code> are now removed.</p><p>All transaction management has been removed from <code>IDatabaseDriver</code> interface, now EM handles
this, passing the transaction context (carried by EM, and created by <code>Connection</code>) to all
driver methods. New methods on EM exists: <code>isInTransaction()</code> and <code>getTransactionContext()</code>.</p><p>In postgres driver, it used to be required to pass parameters as indexed dollar sign
($1, $2, ...), while now knex requires the placeholder to be simple question mark (<code>?</code>),
like in other dialects, so this is now unified with other drivers.</p><h2><a aria-hidden="true" class="anchor" id="manytomany-now-uses-composite-primary-key"></a><a aria-hidden="true" class="hash-link" href="#manytomany-now-uses-composite-primary-key">#</a>ManyToMany now uses composite primary key</h2><p>Previously it was required to have autoincrement primary key for m:n pivot tables. Now this
has changed. By default, only foreign columns are required and composite key over both of them
is used as primary key.</p><p>To preserve stable order of collections, you can force previous behaviour by defining the
m:n property as <code>fixedOrder: true</code>, which will start ordering by <code>id</code> column. You can also
override the order column name via <code>fixedOrderColumn: &#x27;order&#x27;</code>. </p><p>You can also specify default ordering via <code>orderBy: { ... }</code> attribute.</p><h2><a aria-hidden="true" class="anchor" id="strict-filterquery-and-smart-query-conditions"></a><a aria-hidden="true" class="hash-link" href="#strict-filterquery-and-smart-query-conditions">#</a>Strict FilterQuery and smart query conditions</h2><p><code>FilterQuery</code> now does not allow using smart query operators. You can either cast your condition
as any or use object syntax instead (instead of <code>{ &#x27;age:gte&#x27;: 18 }</code> use <code>{ age: { $gte: 18 } }</code>).</p><h2><a aria-hidden="true" class="anchor" id="logging-configuration"></a><a aria-hidden="true" class="hash-link" href="#logging-configuration">#</a>Logging configuration</h2><p>Previously to start logging it was required to provide your custom logger. Logger now defaults
to <code>console.log()</code>, and users can specify what namespaces are they interested in via <code>debug</code>
option. <code>true</code>/<code>false</code> will enable/disable all namespaces.</p><p>Available logger namespaces: <code>&#x27;query&#x27; | &#x27;query-params&#x27; | &#x27;discovery&#x27; | &#x27;info&#x27;</code>.</p><h2><a aria-hidden="true" class="anchor" id="removed-deprecated-fk-option-from-1m-and-m1-decorators"></a><a aria-hidden="true" class="hash-link" href="#removed-deprecated-fk-option-from-1m-and-m1-decorators">#</a>Removed deprecated fk option from 1:m and m:1 decorators</h2><p>Use <code>mappedBy</code>/<code>inversedBy</code> instead.</p><h2><a aria-hidden="true" class="anchor" id="schemageneratorgenerate-is-now-async"></a><a aria-hidden="true" class="hash-link" href="#schemageneratorgenerate-is-now-async">#</a>SchemaGenerator.generate() is now async</h2><p>If you used <code>SchemaGenerator</code>, now there is CLI tool you can use instead. Learn more
in <a href="/docs/v3-new/docs/schema-generator">SchemaGenerator docs</a>. To setup CLI, take a look at
<a href="/docs/v3-new/docs/installation">installation section</a>.</p><h2><a aria-hidden="true" class="anchor" id="new-method-on-namingstrategy-interface"></a><a aria-hidden="true" class="hash-link" href="#new-method-on-namingstrategy-interface">#</a>New method on NamingStrategy interface</h2><p><code>getClassName()</code> is used to find entity class name based on its file name. Now users can
override the default implementation to accommodate their specific needs.</p><p>If you used custom naming strategy, you will either need to implement this method yourself,
or extend <code>AbstractNamingStrategy</code>.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/mikro-orm/mikro-orm/edit/master/docs/upgrading-v2-to-v3.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="contents contents__left-border"><li><a href="#default-value-of-autoflush-has-changed-to-false" class="contents__link">Default value of autoFlush has changed to false</a></li><li><a href="#reworked-entity-definition" class="contents__link">Reworked entity definition</a></li><li><a href="#integrated-knexjs-as-query-builder-and-runner" class="contents__link">Integrated Knex.js as query builder and runner</a></li><li><a href="#manytomany-now-uses-composite-primary-key" class="contents__link">ManyToMany now uses composite primary key</a></li><li><a href="#strict-filterquery-and-smart-query-conditions" class="contents__link">Strict FilterQuery and smart query conditions</a></li><li><a href="#logging-configuration" class="contents__link">Logging configuration</a></li><li><a href="#removed-deprecated-fk-option-from-1m-and-m1-decorators" class="contents__link">Removed deprecated fk option from 1:m and m:1 decorators</a></li><li><a href="#schemageneratorgenerate-is-now-async" class="contents__link">SchemaGenerator.generate() is now async</a></li><li><a href="#new-method-on-namingstrategy-interface" class="contents__link">New method on NamingStrategy interface</a></li></ul></div></div></div></div></div></div></main></div>
</div>

<script type="text/javascript" src="/docs/v3-new/runtime~main.00f02173622193e62e57.js"></script>

<script type="text/javascript" src="/docs/v3-new/main.26dd6f9550a16264f5a7.js"></script>

<script type="text/javascript" src="/docs/v3-new/0.97f9baf7477b81123570.js"></script>

<script type="text/javascript" src="/docs/v3-new/1.56479a3a61faa55d5f04.js"></script>

<script type="text/javascript" src="/docs/v3-new/component---theme-doc-page-1-be-9be.d3bc93f077e7a2f8d173.js"></script>

<script type="text/javascript" src="/docs/v3-new/docsMetadata---v-3-new-docs-988-80a.a30ed25232e4920e6fec.js"></script>

<script type="text/javascript" src="/docs/v3-new/component---theme-doc-item-178-a40.75f4842c571107d99831.js"></script>

<script type="text/javascript" src="/docs/v3-new/content---v-3-new-docs-upgrading-v-2-to-v-33-bf-264.f9a414105e3b8342fb4d.js"></script>

<script type="text/javascript" src="/docs/v3-new/metadata---v-3-new-docs-upgrading-v-2-to-v-3-bb-2-ab9.6a8816928432d6318759.js"></script>

</body>
</html>
